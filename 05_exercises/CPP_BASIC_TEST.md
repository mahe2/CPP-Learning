# C++ 基础综合测试

**测试说明**：
- 本测试分为**理论题**和**编程题**两部分
- 建议时间：90分钟
- 完成后可以查看答案和解析

---

## 📝 Part 1: 理论题（40分，每题2分）

### 一、选择题（10题）

**1. 以下关于C++内存模型的说法，错误的是？**.  C
```
A. 栈内存从高地址向低地址增长
B. 堆内存从低地址向高地址增长
C. 全局变量存储在栈上
D. const常量存储在只读数据段
```

**2. 关于指针和引用，以下说法正确的是？**.     C
```
A. 引用可以重新绑定到另一个对象
B. 指针必须在声明时初始化
C. 引用必须在声明时初始化
D. 指针不能为空
```

**3. 以下哪个智能指针可以被拷贝？**           B
```
A. unique_ptr
B. shared_ptr          
C. auto_ptr
D. weak_ptr
```

**4. 关于构造函数初始化列表，以下说法错误的是？**.   C
```
A. const成员必须在初始化列表中初始化
B. 引用成员必须在初始化列表中初始化
C. 初始化列表的顺序决定了成员的初始化顺序
D. 初始化列表比构造函数体内赋值效率更高
```

**5. 下列代码的输出是什么？**                   D
```cpp
int x = 10;
int& ref = x;
int* ptr = &x;
ref = 20;
*ptr = 30;
cout << x;
```
```
A. 10
B. 20
C. 30
D. 编译错误
```

**6. 关于移动构造函数，以下说法正确的是？**        B
```
A. 移动构造函数进行深拷贝
B. 移动构造函数转移资源所有权
C. Java/Kotlin也有移动构造函数
D. 移动构造函数在C++98就已存在
```

**7. 以下哪种情况必须写析构函数？**              C
```
A. 使用了unique_ptr
B. 使用了vector
C. 使用了裸指针并new了内存
D. 使用了shared_ptr
```

**8. make_unique和make_shared的主要区别是？**       B
```
A. make_unique是C++11特性，make_shared是C++14特性
B. make_unique创建独占指针，make_shared创建共享指针
C. make_unique性能更好
D. make_shared不能用于数组
```

**9. 下列代码中，哪个对象在栈上？**          A
```cpp
int a = 10;
int* b = new int(20);
static int c = 30;
const int d = 40;
```
```
A. 只有a
B. a和d
C. a、c和d
D. 全部
```

**10. 关于const成员函数，以下说法错误的是？**      以下都对
```
A. const成员函数不能修改成员变量
B. const对象只能调用const成员函数
C. const成员函数不能调用非const成员函数
D. const成员函数可以有重载版本
```

### 二、判断题（10题，对的写T，错的写F）

**11. C++的string是栈上分配的，不需要手动释放。** [ F ]

**12. 裸指针是相对于智能指针而言的术语。** [ T ]

**13. 初始化列表的顺序应该与成员声明顺序一致。** [ T ]

**14. shared_ptr的引用计数操作是线程安全的。** [ T ]

**15. 构造函数体内可以进行数据验证和复杂逻辑处理。** [ T ]

**16. vector会自动管理内存，不需要手动delete。** [  T ]

**17. 移动构造函数会让原对象失效（资源被转移）。** [ F ]

**18. const变量必须在定义时初始化。** [ T ]

**19. 引用本质上是一个指针的语法糖。** [ F ]

**20. Rule of Zero建议不要直接管理资源，使用智能指针和STL容器。** [ T ]

---

## 💻 Part 2: 编程题（60分）

### 题目1：智能指针实战（15分）

**要求**：实现一个简单的学生管理系统

```cpp
/**
 * 要求：
 * 1. 使用智能指针（不能用裸指针）
 * 2. Student类包含：姓名、学号、成绩
 * 3. StudentManager类管理多个学生
 * 4. 实现添加学生、删除学生、查找学生、显示所有学生功能
 * 5. 不需要写析构函数（Rule of Zero）
 */

// 在这里实现你的代码
```

### 题目2：构造函数综合应用（15分）

**要求**：实现一个银行账户类

```cpp
/**
 * 要求：
 * 1. 使用初始化列表初始化成员
 * 2. 实现参数构造函数，进行余额验证（负数设为0）
 * 3. 实现拷贝构造函数
 * 4. 实现移动构造函数
 * 5. 在构造函数体内输出日志信息
 * 
 * 成员变量：
 * - string accountNumber (账号)
 * - string owner (所有者)
 * - double balance (余额)
 * - const int accountType (账户类型，1=储蓄 2=支票)
 */

// 在这里实现你的代码
```

### 题目3：内存管理与指针（15分）

**要求**：完成以下函数，找出代码中的问题并修复

```cpp
/**
 * 以下代码有多处内存问题，请：
 * 1. 找出所有问题
 * 2. 说明问题原因
 * 3. 提供正确的实现（使用智能指针）
 */

// 问题代码：
class DataProcessor {
private:
    int* data;
    int size;
    
public:
    DataProcessor(int s) {
        size = s;
        data = new int[size];
    }
    
    void process() {
        for (int i = 0; i <= size; i++) {  // 问题1：？
            data[i] = i * 2;
        }
    }
    
    int* getData() {
        return data;  // 问题2：？
    }
    
    // 问题3：缺少什么？
};

void test() {
    DataProcessor* dp = new DataProcessor(10);
    dp->process();
    int* result = dp->getData();
    // 问题4：缺少什么？
}

// 请在这里写出：
// 1. 问题清单
// 2. 修复后的代码
```

### 题目4：类设计综合题（15分）

**要求**：设计一个图书类和图书馆类

```cpp
/**
 * 要求：
 * 1. Book类：
 *    - 成员：书名(string)、作者(string)、ISBN(string)、是否借出(bool)
 *    - 使用初始化列表
 *    - 提供getter/setter方法
 *    - const成员函数用于显示信息
 * 
 * 2. Library类：
 *    - 使用vector<shared_ptr<Book>>存储图书
 *    - 添加图书
 *    - 借书（根据ISBN）
 *    - 还书（根据ISBN）
 *    - 显示所有图书
 *    - 显示可借图书
 * 
 * 3. 使用Rule of Zero（不需要写析构函数）
 * 4. 要有适当的错误处理
 */

// 在这里实现你的代码
```

---

## 🎯 附加挑战题（不计分，检验深度理解）

### 挑战1：解释下面代码的输出

```cpp
class Test {
private:
    int a;
    int b;
    int c;
    
public:
    Test(int x) : c(x), b(c + 1), a(b + 1) {
        cout << "a=" << a << ", b=" << b << ", c=" << c << endl;
    }
};

int main() {
    Test t(10);
    return 0;
}
```

**问题**：
1. 输出是什么？
2. 为什么会这样？
3. 如何修复？

### 挑战2：智能指针循环引用

```cpp
class Node {
public:
    shared_ptr<Node> next;
    ~Node() { cout << "Node destroyed" << endl; }
};

int main() {
    auto n1 = make_shared<Node>();
    auto n2 = make_shared<Node>();
    n1->next = n2;
    n2->next = n1;
    return 0;
}
```

**问题**：
1. 这段代码有什么问题？
2. 为什么析构函数不会被调用？
3. 如何修复？

---

## 📊 评分标准

### 理论题（40分）
- 选择题：每题2分，共20分
- 判断题：每题2分，共20分

### 编程题（60分）
- 题目1：15分（功能10分，代码质量5分）
- 题目2：15分（功能10分，代码质量5分）
- 题目3：15分（问题识别8分，修复代码7分）
- 题目4：15分（设计10分，实现5分）

### 总分：100分

**等级划分**：
- 90-100分：优秀（A）- 完全掌握
- 80-89分：良好（B）- 基本掌握
- 70-79分：中等（C）- 需要加强
- 60-69分：及格（D）- 需要复习
- <60分：不及格（F）- 建议重新学习

---

## 📝 答题说明

1. **理论题**：请将答案写在单独的文件中
2. **编程题**：请创建独立的cpp文件，能够编译运行
3. **完成后**：告诉我，我会提供答案和详细解析

**建议答题顺序**：
1. 先做理论题（快速过一遍）
2. 再做编程题（按顺序完成）
3. 最后挑战附加题（如果时间充足）

准备好了吗？开始答题吧！💪
