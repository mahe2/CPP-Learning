/**
 * C++ æ„é€ å‡½æ•°å®Œå…¨æŒ‡å—
 * 
 * C++ æœ‰6ç§æ„é€ å‡½æ•°ç±»å‹ï¼Œè¿™æ˜¯ä¸ºäº†ç²¾ç¡®æ§åˆ¶å¯¹è±¡çš„åˆ›å»ºã€å¤åˆ¶ã€ç§»åŠ¨ç­‰è¡Œä¸º
 * Java/Kotlin åªæœ‰æ™®é€šæ„é€ å‡½æ•°ï¼Œå› ä¸ºå®ƒä»¬ä¾èµ– GCï¼Œä¸éœ€è¦è¿™ä¹ˆç²¾ç»†çš„æ§åˆ¶
 */

#include <iostream>
#include <string>
#include <vector>

using namespace std;

class Resource {
private:
    string name;
    int* data;        // åŠ¨æ€åˆ†é…çš„èµ„æº
    size_t size;

public:
    // ============================================
    // 1. é»˜è®¤æ„é€ å‡½æ•° (Default Constructor)
    // ============================================
    // ä¸å¸¦å‚æ•°ï¼Œç”¨äºåˆ›å»º"ç©º"å¯¹è±¡
    // ç±»ä¼¼ Java: public Resource() { }
    Resource() : name("default"), data(nullptr), size(0) {
        cout << "1ï¸âƒ£  é»˜è®¤æ„é€ å‡½æ•°: " << name << endl;
    }
    
    // ============================================
    // 2. å‚æ•°æ„é€ å‡½æ•° (Parameterized Constructor)
    // ============================================
    // å¸¦å‚æ•°ï¼Œç”¨äºåˆå§‹åŒ–å¯¹è±¡
    // ç±»ä¼¼ Java: public Resource(String name, int size) { }
    Resource(string n, size_t s) : name(n), size(s) {
        data = new int[size];  // åˆ†é…å †å†…å­˜
        for (size_t i = 0; i < size; ++i) {
            data[i] = i;
        }
        cout << "2ï¸âƒ£  å‚æ•°æ„é€ å‡½æ•°: " << name << " (size=" << size << ")" << endl;
    }
    
    // ============================================
    // 3. æ‹·è´æ„é€ å‡½æ•° (Copy Constructor) â­ C++ç‰¹æœ‰
    // ============================================
    // ç”¨å·²å­˜åœ¨çš„å¯¹è±¡åˆ›å»ºæ–°å¯¹è±¡ï¼ˆæ·±æ‹·è´ï¼‰
    // æ ¼å¼ï¼šClassName(const ClassName& other)
    // Java/Kotlin ä¸­æ²¡æœ‰è¿™ä¸ªæ¦‚å¿µï¼å®ƒä»¬æ€»æ˜¯æµ…æ‹·è´å¼•ç”¨
    Resource(const Resource& other) : name(other.name + "_copy"), size(other.size) {
        // æ·±æ‹·è´ï¼šé‡æ–°åˆ†é…å†…å­˜ï¼Œå¤åˆ¶æ•°æ®
        data = new int[size];
        for (size_t i = 0; i < size; ++i) {
            data[i] = other.data[i];
        }
        cout << "3ï¸âƒ£  æ‹·è´æ„é€ å‡½æ•°: " << name << " (æ·±æ‹·è´)" << endl;
    }
    
    // ============================================
    // 4. ç§»åŠ¨æ„é€ å‡½æ•° (Move Constructor) â­ C++11ç‰¹æœ‰
    // ============================================
    // è½¬ç§»èµ„æºæ‰€æœ‰æƒï¼Œé¿å…ä¸å¿…è¦çš„å¤åˆ¶ï¼ˆé«˜æ€§èƒ½ï¼‰
    // æ ¼å¼ï¼šClassName(ClassName&& other)
    // Java/Kotlin å®Œå…¨æ²¡æœ‰è¿™ä¸ªæ¦‚å¿µï¼
    Resource(Resource&& other) noexcept 
        : name(other.name + "_moved"), data(other.data), size(other.size) {
        // çªƒå–èµ„æºï¼Œä¸å¤åˆ¶
        other.data = nullptr;  // è®©åŸå¯¹è±¡å¤±æ•ˆ
        other.size = 0;
        cout << "4ï¸âƒ£  ç§»åŠ¨æ„é€ å‡½æ•°: " << name << " (çªƒå–èµ„æº)" << endl;
    }
    
    // ============================================
    // 5. å§”æ‰˜æ„é€ å‡½æ•° (Delegating Constructor) â­ C++11
    // ============================================
    // ä¸€ä¸ªæ„é€ å‡½æ•°è°ƒç”¨å¦ä¸€ä¸ªæ„é€ å‡½æ•°
    // Java ä¸­ç”¨ this()ï¼ŒC++ åœ¨åˆå§‹åŒ–åˆ—è¡¨ä¸­è°ƒç”¨
    Resource(string n) : Resource(n, 10) {  // å§”æ‰˜ç»™å‚æ•°æ„é€ å‡½æ•°
        cout << "5ï¸âƒ£  å§”æ‰˜æ„é€ å‡½æ•°: å§”æ‰˜ç»™ Resource(string, size_t)" << endl;
    }
    
    // ============================================
    // 6. è½¬æ¢æ„é€ å‡½æ•° (Converting Constructor)
    // ============================================
    // å…è®¸éšå¼ç±»å‹è½¬æ¢ï¼ˆå•å‚æ•°æ„é€ å‡½æ•°ï¼‰
    // ç”¨ explicit å¯ä»¥ç¦æ­¢éšå¼è½¬æ¢
    explicit Resource(int s) : name("from_int"), size(s) {
        data = new int[size];
        cout << "6ï¸âƒ£  è½¬æ¢æ„é€ å‡½æ•°: size=" << size << " (explicité˜²æ­¢éšå¼è½¬æ¢)" << endl;
    }
    
    // ============================================
    // ææ„å‡½æ•° (Destructor)
    // ============================================
    // å¯¹è±¡é”€æ¯æ—¶é‡Šæ”¾èµ„æº
    ~Resource() {
        if (data != nullptr) {
            delete[] data;
            cout << "ğŸ’¥ ææ„å‡½æ•°: " << name << " (é‡Šæ”¾å†…å­˜)" << endl;
        } else {
            cout << "ğŸ’¥ ææ„å‡½æ•°: " << name << " (æ— èµ„æº)" << endl;
        }
    }
    
    // æ˜¾ç¤ºä¿¡æ¯
    void show() const {
        cout << "   ğŸ“¦ Resource: " << name << ", size=" << size;
        if (data) cout << ", data[0]=" << data[0];
        cout << endl;
    }
};

// ============================================
// ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¹ˆå¤šæ„é€ å‡½æ•°ï¼Ÿ
// ============================================
void why_so_many_constructors() {
    cout << "\n" << string(60, '=') << endl;
    cout << "ä¸ºä»€ä¹ˆ C++ éœ€è¦è¿™ä¹ˆå¤šæ„é€ å‡½æ•°ï¼Ÿ" << endl;
    cout << string(60, '=') << endl;
    
    cout << "\nåŸå› 1: èµ„æºç®¡ç†ï¼ˆRAIIåŸåˆ™ï¼‰" << endl;
    cout << "---------------------------------------" << endl;
    cout << "C++ éœ€è¦æ‰‹åŠ¨ç®¡ç†å†…å­˜ï¼Œæ‰€ä»¥éœ€è¦ï¼š" << endl;
    cout << "- æ‹·è´æ„é€ å‡½æ•°ï¼šæ·±æ‹·è´èµ„æº" << endl;
    cout << "- ç§»åŠ¨æ„é€ å‡½æ•°ï¼šè½¬ç§»èµ„æºæ‰€æœ‰æƒ" << endl;
    cout << "- ææ„å‡½æ•°ï¼šé‡Šæ”¾èµ„æº" << endl;
    cout << "\nJava/Kotlin: GCè‡ªåŠ¨ç®¡ç†ï¼Œä¸éœ€è¦è¿™äº›" << endl;
    
    cout << "\nåŸå› 2: æ€§èƒ½ä¼˜åŒ–" << endl;
    cout << "---------------------------------------" << endl;
    cout << "ç§»åŠ¨æ„é€ å‡½æ•°é¿å…ä¸å¿…è¦çš„å¤åˆ¶" << endl;
    cout << "ç¤ºä¾‹: vector.push_back() æ‰©å®¹æ—¶" << endl;
    cout << "- æœ‰ç§»åŠ¨æ„é€ : O(n) ç§»åŠ¨ï¼ˆå¿«ï¼‰" << endl;
    cout << "- æ— ç§»åŠ¨æ„é€ : O(n) æ·±æ‹·è´ï¼ˆæ…¢ï¼‰" << endl;
    
    cout << "\nåŸå› 3: ç²¾ç¡®æ§åˆ¶å¯¹è±¡è¡Œä¸º" << endl;
    cout << "---------------------------------------" << endl;
    cout << "explicit: é˜²æ­¢æ„å¤–çš„éšå¼è½¬æ¢" << endl;
    cout << "å§”æ‰˜æ„é€ : å‡å°‘ä»£ç é‡å¤" << endl;
}

// ============================================
// æ¼”ç¤ºå„ç§æ„é€ å‡½æ•°çš„ä½¿ç”¨
// ============================================
void demo_constructors() {
    cout << "\n" << string(60, '=') << endl;
    cout << "æ„é€ å‡½æ•°æ¼”ç¤º" << endl;
    cout << string(60, '=') << endl;
    
    // 1. é»˜è®¤æ„é€ 
    cout << "\n--- 1. é»˜è®¤æ„é€  ---" << endl;
    Resource r1;
    r1.show();
    
    // 2. å‚æ•°æ„é€ 
    cout << "\n--- 2. å‚æ•°æ„é€  ---" << endl;
    Resource r2("myResource", 5);
    r2.show();
    
    // 3. æ‹·è´æ„é€ 
    cout << "\n--- 3. æ‹·è´æ„é€  (æ·±æ‹·è´) ---" << endl;
    Resource r3 = r2;  // è°ƒç”¨æ‹·è´æ„é€ å‡½æ•°
    r3.show();
    r2.show();  // r2 è¿˜å­˜åœ¨ï¼Œæ•°æ®ç‹¬ç«‹
    
    // 4. ç§»åŠ¨æ„é€ 
    cout << "\n--- 4. ç§»åŠ¨æ„é€  (çªƒå–èµ„æº) ---" << endl;
    Resource r4 = std::move(r2);  // è°ƒç”¨ç§»åŠ¨æ„é€ å‡½æ•°
    r4.show();
    r2.show();  // r2 å·²å¤±æ•ˆï¼ˆdata=nullptrï¼‰
    
    // 5. å§”æ‰˜æ„é€ 
    cout << "\n--- 5. å§”æ‰˜æ„é€  ---" << endl;
    Resource r5("delegated");
    r5.show();
    
    // 6. è½¬æ¢æ„é€ ï¼ˆexplicitï¼‰
    cout << "\n--- 6. è½¬æ¢æ„é€  (explicit) ---" << endl;
    Resource r6(20);  // âœ… æ˜¾å¼è°ƒç”¨
    // Resource r7 = 30;  // âŒ ç¼–è¯‘é”™è¯¯ï¼explicit ç¦æ­¢éšå¼è½¬æ¢
    r6.show();
    
    cout << "\n--- å¯¹è±¡å³å°†é”€æ¯ ---" << endl;
}

// ============================================
// ä¸ Java/Kotlin å¯¹æ¯”
// ============================================
void compare_with_java_kotlin() {
    cout << "\n" << string(60, '=') << endl;
    cout << "ä¸ Java/Kotlin å¯¹æ¯”" << endl;
    cout << string(60, '=') << endl;
    
    cout << "\nJava åªæœ‰ 2 ç§æ„é€ å‡½æ•°ï¼š" << endl;
    cout << "---------------------------------------" << endl;
    cout << "class Resource {" << endl;
    cout << "    // 1. é»˜è®¤æ„é€ " << endl;
    cout << "    public Resource() { }" << endl;
    cout << "    " << endl;
    cout << "    // 2. å‚æ•°æ„é€ " << endl;
    cout << "    public Resource(String name, int size) { }" << endl;
    cout << "}" << endl;
    cout << "\nä¸ºä»€ä¹ˆ Java ä¸éœ€è¦æ‹·è´/ç§»åŠ¨æ„é€ ï¼Ÿ" << endl;
    cout << "- Java å¯¹è±¡å¼•ç”¨æ˜¯æµ…æ‹·è´ï¼ŒGC ç®¡ç†å†…å­˜" << endl;
    cout << "- æ²¡æœ‰ææ„å‡½æ•°æ¦‚å¿µ" << endl;
    
    cout << "\n\nKotlin æ›´ç®€æ´ï¼ˆä¸»æ„é€ å‡½æ•°ï¼‰ï¼š" << endl;
    cout << "---------------------------------------" << endl;
    cout << "class Resource(val name: String, val size: Int) {" << endl;
    cout << "    // æ¬¡æ„é€ å‡½æ•°" << endl;
    cout << "    constructor(name: String) : this(name, 10)" << endl;
    cout << "}" << endl;
    cout << "\nKotlin çš„ this() ç±»ä¼¼ C++ çš„å§”æ‰˜æ„é€ " << endl;
    
    cout << "\n\nC++ çš„ä¼˜åŠ¿ï¼š" << endl;
    cout << "---------------------------------------" << endl;
    cout << "âœ… æ‹·è´æ„é€ : æ·±æ‹·è´ï¼Œæ•°æ®ç‹¬ç«‹" << endl;
    cout << "âœ… ç§»åŠ¨æ„é€ : é«˜æ€§èƒ½èµ„æºè½¬ç§»" << endl;
    cout << "âœ… RAII: è‡ªåŠ¨èµ„æºç®¡ç†ï¼ˆæ ˆå¯¹è±¡ï¼‰" << endl;
    cout << "âœ… ç²¾ç¡®æ§åˆ¶: æ¯ä¸ªå¯¹è±¡çš„è¡Œä¸ºå¯å®šåˆ¶" << endl;
    
    cout << "\n\nJava/Kotlin çš„ä¼˜åŠ¿ï¼š" << endl;
    cout << "---------------------------------------" << endl;
    cout << "âœ… ç®€å•: åªéœ€è¦æ™®é€šæ„é€ å‡½æ•°" << endl;
    cout << "âœ… GC: ä¸ç”¨æ‰‹åŠ¨ç®¡ç†å†…å­˜" << endl;
    cout << "âœ… å®‰å…¨: ä¸ä¼šå‡ºç°æ‚¬ç©ºæŒ‡é’ˆ" << endl;
}

// ============================================
// æœ€ä½³å®è·µï¼šRule of Five / Rule of Zero
// ============================================
void best_practices() {
    cout << "\n" << string(60, '=') << endl;
    cout << "æœ€ä½³å®è·µï¼šRule of Five / Rule of Zero" << endl;
    cout << string(60, '=') << endl;
    
    cout << "\nRule of Five (ç®¡ç†èµ„æºçš„ç±»)ï¼š" << endl;
    cout << "---------------------------------------" << endl;
    cout << "å¦‚æœä½ çš„ç±»ç®¡ç†èµ„æºï¼ˆå¦‚æŒ‡é’ˆï¼‰ï¼Œå¿…é¡»å®šä¹‰ï¼š" << endl;
    cout << "1. ææ„å‡½æ•°            ~ClassName()" << endl;
    cout << "2. æ‹·è´æ„é€ å‡½æ•°         ClassName(const ClassName&)" << endl;
    cout << "3. æ‹·è´èµ‹å€¼è¿ç®—ç¬¦       operator=(const ClassName&)" << endl;
    cout << "4. ç§»åŠ¨æ„é€ å‡½æ•°         ClassName(ClassName&&)" << endl;
    cout << "5. ç§»åŠ¨èµ‹å€¼è¿ç®—ç¬¦       operator=(ClassName&&)" << endl;
    
    cout << "\nRule of Zero (æ¨è)ï¼š" << endl;
    cout << "---------------------------------------" << endl;
    cout << "ä¸è¦ç›´æ¥ç®¡ç†èµ„æºï¼Œä½¿ç”¨ RAII å°è£…ï¼š" << endl;
    cout << "âŒ int* data = new int[100];  // æ‰‹åŠ¨ç®¡ç†" << endl;
    cout << "âœ… vector<int> data(100);     // è‡ªåŠ¨ç®¡ç†" << endl;
    cout << "âœ… unique_ptr<int[]> data(new int[100]);" << endl;
    cout << "\nè¿™æ ·ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆæ‰€æœ‰æ„é€ å‡½æ•°ï¼" << endl;
}

// ============================================
// æ„é€ å‡½æ•°åˆå§‹åŒ–è¯­æ³•å¯¹æ¯”
// ============================================
void initialization_syntax() {
    cout << "\n" << string(60, '=') << endl;
    cout << "æ„é€ å‡½æ•°åˆå§‹åŒ–è¯­æ³•å¯¹æ¯”" << endl;
    cout << string(60, '=') << endl;
    
    cout << "\n1. æ„é€ å‡½æ•°ä½“å†…èµ‹å€¼ï¼ˆä¸æ¨èï¼‰ï¼š" << endl;
    cout << "---------------------------------------" << endl;
    cout << "Resource(string n, int s) {" << endl;
    cout << "    name = n;  // å…ˆé»˜è®¤åˆå§‹åŒ–ï¼Œå†èµ‹å€¼ï¼ˆä¸¤æ­¥ï¼‰" << endl;
    cout << "    size = s;" << endl;
    cout << "}" << endl;
    
    cout << "\n2. åˆå§‹åŒ–åˆ—è¡¨ï¼ˆæ¨èï¼‰ï¼š" << endl;
    cout << "---------------------------------------" << endl;
    cout << "Resource(string n, int s) : name(n), size(s) {" << endl;
    cout << "    // ç›´æ¥åˆå§‹åŒ–ï¼ˆä¸€æ­¥ï¼‰ï¼Œæ›´é«˜æ•ˆ" << endl;
    cout << "}" << endl;
    
    cout << "\nä¸ºä»€ä¹ˆæ¨èåˆå§‹åŒ–åˆ—è¡¨ï¼Ÿ" << endl;
    cout << "âœ… æ€§èƒ½æ›´å¥½ï¼ˆç›´æ¥åˆå§‹åŒ–ï¼Œä¸æ˜¯å…ˆé»˜è®¤å†èµ‹å€¼ï¼‰" << endl;
    cout << "âœ… const æˆå‘˜å¿…é¡»ç”¨åˆå§‹åŒ–åˆ—è¡¨" << endl;
    cout << "âœ… å¼•ç”¨æˆå‘˜å¿…é¡»ç”¨åˆå§‹åŒ–åˆ—è¡¨" << endl;
    cout << "âœ… æ²¡æœ‰é»˜è®¤æ„é€ çš„æˆå‘˜å¿…é¡»ç”¨åˆå§‹åŒ–åˆ—è¡¨" << endl;
}

int main() {
    cout << "===========================================" << endl;
    cout << "  C++ æ„é€ å‡½æ•°å®Œå…¨æŒ‡å—" << endl;
    cout << "===========================================" << endl;
    
    why_so_many_constructors();
    demo_constructors();
    compare_with_java_kotlin();
    best_practices();
    initialization_syntax();
    
    cout << "\n===========================================" << endl;
    cout << "æ€»ç»“ï¼šC++ æ„é€ å‡½æ•°çš„è®¾è®¡å“²å­¦" << endl;
    cout << "===========================================" << endl;
    cout << "1. ç²¾ç¡®æ§åˆ¶ï¼šæ¯ç§æ„é€ æ–¹å¼éƒ½æœ‰æ˜ç¡®ç”¨é€”" << endl;
    cout << "2. æ€§èƒ½ä¼˜åŒ–ï¼šç§»åŠ¨æ„é€ é¿å…ä¸å¿…è¦çš„å¤åˆ¶" << endl;
    cout << "3. èµ„æºç®¡ç†ï¼šRAII åŸåˆ™ï¼Œæ„é€ è·å–èµ„æºï¼Œææ„é‡Šæ”¾" << endl;
    cout << "4. é›¶å¼€é”€æŠ½è±¡ï¼šä¸ç”¨çš„åŠŸèƒ½ä¸ä»˜å‡ºä»£ä»·" << endl;
    cout << "\nå¯¹æ¯” Java/Kotlinï¼š" << endl;
    cout << "- å®ƒä»¬ç®€å•ä½†ç¼ºå°‘ç²¾ç¡®æ§åˆ¶" << endl;
    cout << "- C++ å¤æ‚ä½†æ¢æ¥æ€§èƒ½å’Œçµæ´»æ€§" << endl;
    cout << "===========================================" << endl;
    
    return 0;
}

/**
 * å¿«é€Ÿå‚è€ƒè¡¨ï¼šC++ æ„é€ å‡½æ•°ç±»å‹
 * 
 * â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 * â”‚  æ„é€ å‡½æ•°ç±»å‹    â”‚  è¯­æ³•                â”‚  è°ƒç”¨æ—¶æœº     â”‚ Java/Kotlin â”‚
 * â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 * â”‚ é»˜è®¤æ„é€         â”‚ Class()             â”‚ Class obj;   â”‚ âœ… æœ‰       â”‚
 * â”‚ å‚æ•°æ„é€         â”‚ Class(T1, T2)       â”‚ Class obj(a) â”‚ âœ… æœ‰       â”‚
 * â”‚ æ‹·è´æ„é€  â­     â”‚ Class(const Class&) â”‚ Class b = a; â”‚ âŒ æ—        â”‚
 * â”‚ ç§»åŠ¨æ„é€  â­     â”‚ Class(Class&&)      â”‚ Class b=move â”‚ âŒ æ—        â”‚
 * â”‚ å§”æ‰˜æ„é€         â”‚ Class() : Class(10) â”‚ æ„é€ æ—¶       â”‚ âœ… this()  â”‚
 * â”‚ è½¬æ¢æ„é€         â”‚ explicit Class(int) â”‚ Class obj(5) â”‚ âš ï¸  ç±»ä¼¼    â”‚
 * â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 * 
 * è®°å¿†å£è¯€ï¼š
 * - é»˜è®¤å‚æ•°æ˜¯åŸºç¡€ï¼ˆdefault, parameterizedï¼‰
 * - æ‹·è´ç§»åŠ¨ä¸ºæ€§èƒ½ï¼ˆcopy, moveï¼‰
 * - å§”æ‰˜è½¬æ¢ä¸ºä¾¿åˆ©ï¼ˆdelegating, convertingï¼‰
 * 
 * æœ€é‡è¦çš„åŒºåˆ«ï¼š
 * C++ çš„æ‹·è´æ„é€ å’Œç§»åŠ¨æ„é€ æ˜¯ Java/Kotlin å®Œå…¨æ²¡æœ‰çš„æ¦‚å¿µï¼
 * è¿™æ˜¯å› ä¸º C++ éœ€è¦ç²¾ç¡®æ§åˆ¶èµ„æºï¼ˆå†…å­˜ï¼‰çš„ç®¡ç†ã€‚
 */
